<button id="sim-btn" class="btn-sim" onclick="toggleSimulator()">üìç Mode: Real GPS</button>

<style>
    .btn-sim { 
        background: #95a5a6; color: white; border: none; padding: 8px; 
        width: 100%; border-radius: 10px; font-weight: bold; cursor: pointer; margin-top: 8px;
        font-size: 0.7rem; text-transform: uppercase;
    }
    .sim-active { background: #d35400 !important; }
</style>

<script>
    let isSimulating = false;
    const RICHMOND_CENTER = [51.442, -0.285]; // Near Pen Ponds

    function toggleSimulator() {
        isSimulating = !isSimulating;
        const btn = document.getElementById('sim-btn');
        
        if (isSimulating) {
            btn.classList.add('sim-active');
            btn.innerText = "üìç Mode: Simulated (Pen Ponds)";
            // Move map to the park instantly
            map.flyTo(RICHMOND_CENTER, 15);
            console.log("DAPP Simulator: Position set to Richmond Park.");
        } else {
            btn.classList.remove('sim-active');
            btn.innerText = "üìç Mode: Real GPS";
            // In a real app, this would trigger navigator.geolocation.getCurrentPosition
            alert("Switching back to your actual GPS location.");
        }
    }

    // Modify your reporting logic to use the simulated center
    function submitSighting() {
        const reportLocation = isSimulating ? RICHMOND_CENTER : [map.getCenter().lat, map.getCenter().lng];
        
        // This ensures your "Precise" data for Rangers is always in the park during testing
        console.log(`PROTOTYPE LOG: Sighting reported at ${reportLocation}`);
        
        // Audio & Haptic feedback
        const audio = document.getElementById('alert-sound');
        if(audio) audio.play().catch(() => {});
        if ("vibrate" in navigator) navigator.vibrate(200);

        alert("Sighting Recorded! (Using " + (isSimulating ? "Simulated" : "Real") + " Location)");
        cancelReporting();
    }
</script>
