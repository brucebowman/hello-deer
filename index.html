<button class="btn-gate" onclick="findNearestGate()">üìç Find Nearest Exit</button>

<style>
    .btn-gate {
        background: #34495e; color: white; border: none; padding: 10px;
        width: 100%; border-radius: 10px; font-weight: bold; cursor: pointer; margin-top: 8px;
    }
    .gate-marker { background: #2d5a27; color: white; padding: 2px 5px; border-radius: 4px; font-size: 10px; font-weight: bold; }
</style>

<script>
    // Richmond Park Gate Data (Coordinates)
    const gates = [
        { name: "Richmond Gate", lat: 51.4505, lng: -0.2963 },
        { name: "Roehampton Gate", lat: 51.4535, lng: -0.2562 },
        { name: "Kingston Gate", lat: 51.4255, lng: -0.2831 },
        { name: "Ham Gate", lat: 51.4326, lng: -0.3069 },
        { name: "Sheen Gate", lat: 51.4632, lng: -0.2741 },
        { name: "Ladderstile Gate", lat: 51.4265, lng: -0.2718 }, // Pedestrian
        { name: "Robin Hood Gate", lat: 51.4402, lng: -0.2538 } // Pedestrian
    ];

    // Add visual markers for gates to the map
    gates.forEach(gate => {
        L.marker([gate.lat, gate.lng], {
            icon: L.divIcon({ className: 'gate-marker', html: gate.name })
        }).addTo(map);
    });

    function findNearestGate() {
        // In a real app, we'd use navigator.geolocation.getCurrentPosition
        // For the prototype, we use the map center
        const userLoc = map.getCenter();
        let closest = gates[0];
        let minDist = Infinity;

        gates.forEach(gate => {
            const d = map.distance([userLoc.lat, userLoc.lng], [gate.lat, gate.lng]);
            if (d < minDist) {
                minDist = d;
                closest = gate;
            }
        });

        const distKm = (minDist / 1000).toFixed(1);
        alert(`Nearest exit: ${closest.name}\nDistance: ${distKm} km\n\nNote: All gates lock at 20:00!`);
        map.setView([closest.lat, closest.lng], 15);
    }
</script>
